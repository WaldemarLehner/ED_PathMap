{"version":3,"sources":["webpack:///./src/webworkers/prepareData/main.js","webpack:///./src/webworkers/prepareData/dateOperations.js","webpack:///./node_modules/moment/locale sync ^\\.\\/.*$","webpack:///./src/webworkers/prepareData/generateF.js","webpack:///./src/webworkers/prepareData/generateColorsAnSizes.js","webpack:///./src/configuration/drawParameters.js"],"names":["date","require","filterData","jsonData","url","generate","json","TypeError","_typeof","obj","key","hasOwnProperty","isObjEmpty","isValid","forEach","element","time","retval","isNum","x","y","z","name","dateVisited","test","isElementValid","validateJSON","Error","array","indices","slice","removeDatesOutOfBounds","getIndexDateBounds","getDateLimits","SystemMap","systemMap","ConnectionMap","connectionMap","maxValues","systems","max","connections","logs","maps","map","drawInstructions","num","isNaN","self","addEventListener","msg","retObj","push","cmd","params","data","console","log","postMessage","close","moment","addToBounds","i","bounds","limits","module","exports","length","validateURL","split","dates","substring","lastIndexOf","error","time1","time2","valueOf","reverse","warn","addDateLimitsToSettingsUI","retArr","unix","getBounds","./af","./af.js","./ar","./ar-dz","./ar-dz.js","./ar-kw","./ar-kw.js","./ar-ly","./ar-ly.js","./ar-ma","./ar-ma.js","./ar-sa","./ar-sa.js","./ar-tn","./ar-tn.js","./ar.js","./az","./az.js","./be","./be.js","./bg","./bg.js","./bm","./bm.js","./bn","./bn.js","./bo","./bo.js","./br","./br.js","./bs","./bs.js","./ca","./ca.js","./cs","./cs.js","./cv","./cv.js","./cy","./cy.js","./da","./da.js","./de","./de-at","./de-at.js","./de-ch","./de-ch.js","./de.js","./dv","./dv.js","./el","./el.js","./en-SG","./en-SG.js","./en-au","./en-au.js","./en-ca","./en-ca.js","./en-gb","./en-gb.js","./en-ie","./en-ie.js","./en-il","./en-il.js","./en-nz","./en-nz.js","./eo","./eo.js","./es","./es-do","./es-do.js","./es-us","./es-us.js","./es.js","./et","./et.js","./eu","./eu.js","./fa","./fa.js","./fi","./fi.js","./fo","./fo.js","./fr","./fr-ca","./fr-ca.js","./fr-ch","./fr-ch.js","./fr.js","./fy","./fy.js","./ga","./ga.js","./gd","./gd.js","./gl","./gl.js","./gom-latn","./gom-latn.js","./gu","./gu.js","./he","./he.js","./hi","./hi.js","./hr","./hr.js","./hu","./hu.js","./hy-am","./hy-am.js","./id","./id.js","./is","./is.js","./it","./it-ch","./it-ch.js","./it.js","./ja","./ja.js","./jv","./jv.js","./ka","./ka.js","./kk","./kk.js","./km","./km.js","./kn","./kn.js","./ko","./ko.js","./ku","./ku.js","./ky","./ky.js","./lb","./lb.js","./lo","./lo.js","./lt","./lt.js","./lv","./lv.js","./me","./me.js","./mi","./mi.js","./mk","./mk.js","./ml","./ml.js","./mn","./mn.js","./mr","./mr.js","./ms","./ms-my","./ms-my.js","./ms.js","./mt","./mt.js","./my","./my.js","./nb","./nb.js","./ne","./ne.js","./nl","./nl-be","./nl-be.js","./nl.js","./nn","./nn.js","./pa-in","./pa-in.js","./pl","./pl.js","./pt","./pt-br","./pt-br.js","./pt.js","./ro","./ro.js","./ru","./ru.js","./sd","./sd.js","./se","./se.js","./si","./si.js","./sk","./sk.js","./sl","./sl.js","./sq","./sq.js","./sr","./sr-cyrl","./sr-cyrl.js","./sr.js","./ss","./ss.js","./sv","./sv.js","./sw","./sw.js","./ta","./ta.js","./te","./te.js","./tet","./tet.js","./tg","./tg.js","./th","./th.js","./tl-ph","./tl-ph.js","./tlh","./tlh.js","./tr","./tr.js","./tzl","./tzl.js","./tzm","./tzm-latn","./tzm-latn.js","./tzm.js","./ug-cn","./ug-cn.js","./uk","./uk.js","./ur","./ur.js","./uz","./uz-latn","./uz-latn.js","./uz.js","./vi","./vi.js","./x-pseudo","./x-pseudo.js","./yo","./yo.js","./zh-cn","./zh-cn.js","./zh-hk","./zh-hk.js","./zh-tw","./zh-tw.js","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","code","keys","Object","resolve","createNewConnection","sys1","sys2","getConnectionName","count","overrideIfGreater","value","greaterThanThis","name1","name2","toUpperCase","localeCompare","index","system","el","coords","maxVisits","iterator","sys","connection","points","lines","instructions","color","generateColorsAndSizes","generateColor","size","generatePointSize","position","generatePointInstructions","thisObject","nextObject","nextnextObject","thisConnection","nextConnection","isUndef","generateLineInstructions","definitions","chroma","Interpolate","set1","set2","valpos","isPoint","minmax","def","useMaxValueFromLogsInstead","maxVal","minVal","scale","colorGradient","mode","domain","useSizeMapperInstead","sizeDef","sizeMapper","sizeValues","brokeOut","getSizeMapperSize","useAbsoluteValues","min","minSize","maxSize"],"mappings":"+VAIA,IAAMA,EAAOC,EAAQ,KAqBrB,SAASC,EAAWC,EAASC,GAC5B,IAAMC,EAAWJ,EAAQ,KACzB,IAwCD,SAAsBK,GACrB,QAAmB,IAATA,EACT,MAAM,IAAIC,UAAU,mFAErB,GAAmB,WAAhBC,EAAOF,GACT,MAAM,IAAIC,UAAU,gGAErB,GAkDD,SAAoBE,GACnB,IAAK,IAAIC,KAAOD,EACf,GAAIA,EAAIE,eAAeD,GACtB,OAAO,EAET,OAAO,EAvDJE,CAAWN,GACb,MAAM,IAAIC,UAAU,mCAErB,IAAIM,GAAU,EAMd,OALAP,EAAKQ,QAAQ,SAAAC,IASd,SAAwBT,GACvB,QAAmB,IAATA,EACT,MAAM,IAAIC,UAAU,iGACf,GAAmB,WAAhBC,EAAOF,GACf,MAAM,IAAIC,UAAU,gGAErB,IAkB4BS,EAlBxBC,GAAS,EAYb,OAXIC,EAAMZ,EAAKa,IAAOD,EAAMZ,EAAKc,IAAOF,EAAMZ,EAAKe,KAClDJ,GAAS,GAEc,iBAAdX,EAAKgB,OACdL,GAAS,GAEqB,iBAArBX,EAAKiB,YACdN,GAAS,EAWS,iBADSD,EATIV,EAAKiB,cAcxB,6PACCC,KAAKR,KAdlBC,GAAS,GAEHA,GA1BFQ,CAAeV,KAClBF,GAAU,KAGLA,EAxDHa,CAAavB,GAAW,MAAM,IAAIwB,MAAM,6CAE5CxB,EAiCD,SAAgCyB,EAAMC,GACrC,OAAOD,EAAME,MAAMD,EAAQ,GAAGA,EAAQ,IAlC3BE,CAAuB5B,EADpBH,EAAKgC,mBAAmB7B,EAASH,EAAKiC,cAAc7B,KAIlE,IAAI8B,EAAY7B,EAAS8B,UAAUhC,GAE/BiC,EAAgB/B,EAASgC,cAAclC,GACvCmC,EAAY,CAACC,QAASL,EAAUM,IAAIC,YAAaL,EAAcI,KAgBnE,MATW,CACVE,KAAMvC,EACNwC,KAAM,CACLJ,QATFL,EAAYA,EAAUU,IAUpBH,YATFL,EAAgBA,EAAcQ,KAW7BC,iBAPsBxC,EAASwC,iBAAiB1C,EAAS+B,EAAUE,EAAcE,IA+EnF,SAASpB,EAAM4B,GACd,MAAsB,iBAARA,IAAqBC,MAAMD,GAlH1CE,KAAKC,iBAAiB,UAAU,SAASC,GACxC,IAAIC,EAAS,GAAGC,KAAK,CACpBC,IAAK,kBACLC,OAAQpD,EAAWgD,EAAIK,KAAKjD,KAAM4C,EAAIK,KAAKnD,OAE5CoD,QAAQC,IAAIN,GACZH,KAAKU,YAAYP,GAEjBQ,+BCfD,IAAMC,EAAS3D,EAAQ,GACRA,EAAQ,KAgFvB,SAAS4D,EAAYC,EAAEC,EAAO/C,EAAKgD,GAOlC,OANIhD,GAAQgD,EAAO,IAClBD,EAAOX,KAAKU,GAET9C,GAAQgD,EAAO,IAClBD,EAAOX,KAAY,IAANU,EAAW,EAAIA,EAAI,GAE1BC,EApFRE,EAAOC,QAAU,CAChBjC,cAQD,SAAuB7B,GAItB,GAyCD,SAAqBA,GACpB,GAAmB,iBAARA,EACV,MAAM,IAAIG,UAAU,kCAErB,GAAmB,IAAfH,EAAI+D,OACP,MAAM,IAAIxC,MAAM,+BAhDjByC,CAAYhE,GAEM,KADlBA,EAAMA,EAAIiE,MAAM,IAAI,IACbF,OAEN,OAAO,EAER,IACIG,EADSlE,EAAI,GAAGmE,UAAUnE,EAAI,GAAGoE,YAAY,UAAU,EAAEpE,EAAI,GAAGoE,YAAY,YAC7DH,MAAM,IAAI,GAC7B,GAAoB,IAAjBC,EAAMH,OAER,OADAX,QAAQiB,MAAM,yDACP,EA0CwBC,EAxCJJ,EAAM,GAwCIK,EAxCDL,EAAM,GAyCnCI,EAAME,UAAYD,EAAMC,YAvC/BN,EAAQA,EAAMO,UACdrB,QAAQsB,KAAK,4DAqCf,IAAiCJ,EAAMC,GA7BvC,SAAmCL,GAOlCtB,KAAKU,YAAY,CAAC,CACjBL,IAAI,KACJC,OAAOgB,KAfRS,CAA0BT,GAC1B,IAAIU,EAAS,CAACpB,EAAOqB,KAAKX,EAAM,IAAIW,OAAQrB,EAAOqB,KAAKX,EAAM,IAAIW,QAElE,OADAzB,QAAQC,IAAIuB,GACLA,GA7BPhD,mBA8CD,SAA4BuB,EAAKS,GAGhC,OAgBD,SAAmBT,EAAKS,GAEvB,IADA,IAAID,EAAS,GACLD,EAAI,EAAEA,EAAEP,EAAKY,OAAO,EAAEL,IAAI,CACjC,IAAI9C,EAAO4C,EAAOL,EAAKO,GAAGvC,aAAa0D,OAEvClB,EAASF,EAAYC,EAAEC,EAAO/C,EAAKgD,GAEpC,OAAOD,EAxBMmB,CAAU3B,EAAMS,0BCtD9B,IAAApB,EAAA,CACAuC,OAAA,EACAC,UAAA,EACAC,OAAA,EACAC,UAAA,EACAC,aAAA,EACAC,UAAA,EACAC,aAAA,EACAC,UAAA,EACAC,aAAA,EACAC,UAAA,EACAC,aAAA,EACAC,UAAA,EACAC,aAAA,EACAC,UAAA,EACAC,aAAA,EACAC,UAAA,EACAC,OAAA,EACAC,UAAA,EACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,gBAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,UAAA,GACAC,aAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,UAAA,GACAC,aAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,YAAA,IACAC,eAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA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","file":"/webworkers/prepareData.worker.js","sourcesContent":["//This file will probably be executed by a webworker in the background.\r\n\r\n\r\n\r\nconst date = require(\"./dateOperations\");\r\n\r\n\r\nself.addEventListener(\"message\",function(msg){\r\n\tlet retObj = [].push({\r\n\t\tcmd: \"setPreparedData\",\r\n\t\tparams: filterData(msg.data.json, msg.data.url)\r\n\t});\r\n\tconsole.log(retObj);\r\n\tself.postMessage(retObj);\r\n\t\r\n\tclose();\r\n});\r\n\r\n\r\n\r\n/**\r\n *\r\n *\r\n * @param {Array} jsonData An Array that represents the players entire travel log. \r\n */\r\nfunction filterData(jsonData,url){\r\n\tconst generate = require(\"./generateF\");\r\n\tif(!validateJSON(jsonData)){throw new Error(\"Passed Logs have an unexpected structure.\");}\r\n\tlet indices = date.getIndexDateBounds(jsonData,date.getDateLimits(url));\r\n\tjsonData = removeDatesOutOfBounds(jsonData,indices);\r\n\t\r\n\t//An Object holdings all Systems with coords, name and amount of visits\r\n\tlet SystemMap = generate.systemMap(jsonData);\r\n\t//An Object holding all connections with name and amount of visits\r\n\tlet ConnectionMap = generate.connectionMap(jsonData);\r\n\tlet maxValues = {systems: SystemMap.max,connections: ConnectionMap.max};\r\n\tSystemMap = SystemMap.map;\r\n\tConnectionMap = ConnectionMap.map;\r\n\t//This will be used to draw the actual data onto the THREE canvas. \r\n\t//It has two objects, \"systems\" and \"connections\" and is fed to\r\n\t//the CanvasInterface to draw the points.\r\n\tlet drawInstructions = generate.drawInstructions(jsonData,SystemMap,ConnectionMap,maxValues);\r\n\tlet data = {\r\n\t\tlogs: jsonData,\r\n\t\tmaps: {\r\n\t\t\tsystems: SystemMap,\r\n\t\t\tconnections: ConnectionMap\r\n\t\t},\r\n\t\tdrawInstructions: drawInstructions\r\n\t};\r\n\t\r\n\treturn data;\r\n}\r\n\r\n\r\n/**\r\n * Returns the Array without the data that is not looked at.\r\n *\r\n * @param {Array} array\r\n * @param {number[]} indices\r\n * @returns {Array}\r\n */\r\nfunction removeDatesOutOfBounds(array,indices){\r\n\treturn array.slice(indices[0],indices[1]);\r\n}\r\n\r\n\r\nfunction validateJSON(json){\r\n\tif(typeof json === \"undefined\"){\r\n\t\tthrow new TypeError(\"No argument has been passed. This method needs the logs as object to be passed.\");\r\n\t}\r\n\tif(typeof json !== \"object\"){\r\n\t\tthrow new TypeError(\"Passed argument needs to be typeof object. An object that represents an entry from the logs.\");\r\n\t}\r\n\tif(isObjEmpty(json)){\r\n\t\tthrow new TypeError(\"An empty object has been passed\");\r\n\t}\r\n\tlet isValid = true;\r\n\tjson.forEach(element => {\r\n\t\tif(!isElementValid(element)){\r\n\t\t\tisValid = false;\r\n\t\t}\r\n\t});\r\n\treturn isValid;\r\n}\r\n\r\n\r\nfunction isElementValid(json){\r\n\tif(typeof json === \"undefined\"){\r\n\t\tthrow new TypeError(\"No argument has been passed. This method needs an entry from the logs as object to be passed.\");\r\n\t}else if(typeof json !== \"object\"){\r\n\t\tthrow new TypeError(\"Passed argument needs to be typeof object. An object that represents an entry from the logs.\");\r\n\t}\r\n\tlet retval = true;\r\n\tif(!isNum(json.x) || !isNum(json.y) || !isNum(json.z)) {\r\n\t\tretval = false;\r\n\t}\r\n\tif(typeof json.name !== \"string\"){\r\n\t\tretval = false;\r\n\t}\r\n\tif(typeof json.dateVisited !== \"string\"){\r\n\t\tretval = false;\r\n\t} else if (!isTimeInRightFormat(json.dateVisited)){\r\n\t\tretval = false;\r\n\t}\r\n\treturn retval;\r\n}\r\n/**\r\n\r\n * @param {string} time\r\n */\r\nfunction isTimeInRightFormat(time){\r\n\tif(typeof time !== \"string\"){\r\n\t\treturn false;\r\n\t}\r\n\t//from https://gist.github.com/x-strong/5378739\r\n\tlet regexp = /^(?:(?!0000)[0-9]{4}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29)\\s([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$/;\r\n\treturn regexp.test(time);\r\n}\r\n\r\nfunction isNum(num){\r\n\treturn typeof num === \"number\" && !isNaN(num);\r\n}\r\n\r\nfunction isObjEmpty(obj) {\r\n\tfor (var key in obj) {\r\n\t\tif (obj.hasOwnProperty(key))\r\n\t\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}","const moment = require(\"moment\");\r\nconst jQuery = require(\"jquery\");\r\n\r\n\r\nmodule.exports = {\r\n\tgetDateLimits: getDateLimits,\r\n\tgetIndexDateBounds: getIndexDateBounds\r\n};\r\n\r\n\r\n/**\r\n * @exports [number,number]\r\n */\r\nfunction getDateLimits(url){\r\n\t\r\n\tvalidateURL(url);\r\n\turl = url.split(\"?\",2);\r\n\tif(url.length === 1){\r\n\t\t// No Date limiters\r\n\t\treturn false;\r\n\t}\r\n\tlet params = url[1].substring(url[1].lastIndexOf(\"[DATE]\")+6,url[1].lastIndexOf(\"[/DATE]\"));\r\n\tlet dates = params.split(\";\",2);\r\n\tif(dates.length !== 2){\r\n\t\tconsole.error(\"URL is set up incorrect. Ignoring filtering by date.\");\r\n\t\treturn false;\r\n\t}\r\n\tif (isTimeAGreaterThanTimeB(dates[0],dates[1])){\r\n\t\t\r\n\t\tdates = dates.reverse();\r\n\t\tconsole.warn(\"First date was greater than last date. Reversing order.\");\r\n\t}\r\n\taddDateLimitsToSettingsUI(dates);\r\n\tlet retArr = [moment.unix(dates[0]).unix(), moment.unix(dates[1]).unix()];\r\n\tconsole.log(retArr);\r\n\treturn retArr;\r\n\r\n}\r\nfunction addDateLimitsToSettingsUI(dates){\r\n\t/*\r\n\tjQuery(\"#check_limit_selection > input\").prop(\"checked\", true);\r\n\tjQuery(\"#daterange\").removeClass(\"hidden\");\r\n\tlet daterange_txt = (moment(dates[0]).format(\"YYYY-MM-DD\")) + \" - \"(moment(dates[0]).format(\"YYYY-MM-DD\"));\r\n\tjQuery(\"#daterange\").val(daterange_txt);\r\n\t*/\r\n\tself.postMessage([{\r\n\t\tcmd:\"UI\",\r\n\t\tparams:dates\r\n\t}]);\r\n}\r\n\r\n\r\nfunction getIndexDateBounds(data,limits){\r\n\t//Get Lower Bound\r\n\tlet retArr = getBounds(data, limits);\r\n\treturn retArr;\r\n}\r\n\r\nfunction validateURL(url){\r\n\tif (typeof url !== \"string\") {\r\n\t\tthrow new TypeError(\"Given URL is not typeof string\");\r\n\t}\r\n\tif (url.length === 0) {\r\n\t\tthrow new Error(\"Given URL string is 0 long.\");\r\n\t}\r\n}\r\n\r\nfunction isTimeAGreaterThanTimeB(time1,time2){\r\n\treturn (time1.valueOf() > time2.valueOf()) ? true : false;\t\r\n}\r\n\r\nfunction getBounds(data,limits) {\r\n\tlet bounds = [];\r\n\tfor(let i = 0;i<data.length-1;i++){\r\n\t\tlet time = moment(data[i].dateVisited).unix();\r\n\t\t//Look for left bound. If true. Left bound found.\r\n\t\tbounds = addToBounds(i,bounds,time,limits);\r\n\t}\r\n\treturn bounds;\r\n}\r\n\r\nfunction addToBounds(i,bounds,time,limits){\r\n\tif (time >= limits[0])\r\n\t\tbounds.push(i);\r\n\r\n\tif (time >= limits[1])\r\n\t\tbounds.push((i === 0) ? 0 : i - 1);\r\n\r\n\treturn bounds;\r\n}\r\n\r\n","var map = {\n\t\"./af\": 1,\n\t\"./af.js\": 1,\n\t\"./ar\": 2,\n\t\"./ar-dz\": 3,\n\t\"./ar-dz.js\": 3,\n\t\"./ar-kw\": 4,\n\t\"./ar-kw.js\": 4,\n\t\"./ar-ly\": 5,\n\t\"./ar-ly.js\": 5,\n\t\"./ar-ma\": 6,\n\t\"./ar-ma.js\": 6,\n\t\"./ar-sa\": 7,\n\t\"./ar-sa.js\": 7,\n\t\"./ar-tn\": 8,\n\t\"./ar-tn.js\": 8,\n\t\"./ar.js\": 2,\n\t\"./az\": 9,\n\t\"./az.js\": 9,\n\t\"./be\": 10,\n\t\"./be.js\": 10,\n\t\"./bg\": 11,\n\t\"./bg.js\": 11,\n\t\"./bm\": 12,\n\t\"./bm.js\": 12,\n\t\"./bn\": 13,\n\t\"./bn.js\": 13,\n\t\"./bo\": 14,\n\t\"./bo.js\": 14,\n\t\"./br\": 15,\n\t\"./br.js\": 15,\n\t\"./bs\": 16,\n\t\"./bs.js\": 16,\n\t\"./ca\": 17,\n\t\"./ca.js\": 17,\n\t\"./cs\": 18,\n\t\"./cs.js\": 18,\n\t\"./cv\": 19,\n\t\"./cv.js\": 19,\n\t\"./cy\": 20,\n\t\"./cy.js\": 20,\n\t\"./da\": 21,\n\t\"./da.js\": 21,\n\t\"./de\": 22,\n\t\"./de-at\": 23,\n\t\"./de-at.js\": 23,\n\t\"./de-ch\": 24,\n\t\"./de-ch.js\": 24,\n\t\"./de.js\": 22,\n\t\"./dv\": 25,\n\t\"./dv.js\": 25,\n\t\"./el\": 26,\n\t\"./el.js\": 26,\n\t\"./en-SG\": 27,\n\t\"./en-SG.js\": 27,\n\t\"./en-au\": 28,\n\t\"./en-au.js\": 28,\n\t\"./en-ca\": 29,\n\t\"./en-ca.js\": 29,\n\t\"./en-gb\": 30,\n\t\"./en-gb.js\": 30,\n\t\"./en-ie\": 31,\n\t\"./en-ie.js\": 31,\n\t\"./en-il\": 32,\n\t\"./en-il.js\": 32,\n\t\"./en-nz\": 33,\n\t\"./en-nz.js\": 33,\n\t\"./eo\": 34,\n\t\"./eo.js\": 34,\n\t\"./es\": 35,\n\t\"./es-do\": 36,\n\t\"./es-do.js\": 36,\n\t\"./es-us\": 37,\n\t\"./es-us.js\": 37,\n\t\"./es.js\": 35,\n\t\"./et\": 38,\n\t\"./et.js\": 38,\n\t\"./eu\": 39,\n\t\"./eu.js\": 39,\n\t\"./fa\": 40,\n\t\"./fa.js\": 40,\n\t\"./fi\": 41,\n\t\"./fi.js\": 41,\n\t\"./fo\": 42,\n\t\"./fo.js\": 42,\n\t\"./fr\": 43,\n\t\"./fr-ca\": 44,\n\t\"./fr-ca.js\": 44,\n\t\"./fr-ch\": 45,\n\t\"./fr-ch.js\": 45,\n\t\"./fr.js\": 43,\n\t\"./fy\": 46,\n\t\"./fy.js\": 46,\n\t\"./ga\": 47,\n\t\"./ga.js\": 47,\n\t\"./gd\": 48,\n\t\"./gd.js\": 48,\n\t\"./gl\": 49,\n\t\"./gl.js\": 49,\n\t\"./gom-latn\": 50,\n\t\"./gom-latn.js\": 50,\n\t\"./gu\": 51,\n\t\"./gu.js\": 51,\n\t\"./he\": 52,\n\t\"./he.js\": 52,\n\t\"./hi\": 53,\n\t\"./hi.js\": 53,\n\t\"./hr\": 54,\n\t\"./hr.js\": 54,\n\t\"./hu\": 55,\n\t\"./hu.js\": 55,\n\t\"./hy-am\": 56,\n\t\"./hy-am.js\": 56,\n\t\"./id\": 57,\n\t\"./id.js\": 57,\n\t\"./is\": 58,\n\t\"./is.js\": 58,\n\t\"./it\": 59,\n\t\"./it-ch\": 60,\n\t\"./it-ch.js\": 60,\n\t\"./it.js\": 59,\n\t\"./ja\": 61,\n\t\"./ja.js\": 61,\n\t\"./jv\": 62,\n\t\"./jv.js\": 62,\n\t\"./ka\": 63,\n\t\"./ka.js\": 63,\n\t\"./kk\": 64,\n\t\"./kk.js\": 64,\n\t\"./km\": 65,\n\t\"./km.js\": 65,\n\t\"./kn\": 66,\n\t\"./kn.js\": 66,\n\t\"./ko\": 67,\n\t\"./ko.js\": 67,\n\t\"./ku\": 68,\n\t\"./ku.js\": 68,\n\t\"./ky\": 69,\n\t\"./ky.js\": 69,\n\t\"./lb\": 70,\n\t\"./lb.js\": 70,\n\t\"./lo\": 71,\n\t\"./lo.js\": 71,\n\t\"./lt\": 72,\n\t\"./lt.js\": 72,\n\t\"./lv\": 73,\n\t\"./lv.js\": 73,\n\t\"./me\": 74,\n\t\"./me.js\": 74,\n\t\"./mi\": 75,\n\t\"./mi.js\": 75,\n\t\"./mk\": 76,\n\t\"./mk.js\": 76,\n\t\"./ml\": 77,\n\t\"./ml.js\": 77,\n\t\"./mn\": 78,\n\t\"./mn.js\": 78,\n\t\"./mr\": 79,\n\t\"./mr.js\": 79,\n\t\"./ms\": 80,\n\t\"./ms-my\": 81,\n\t\"./ms-my.js\": 81,\n\t\"./ms.js\": 80,\n\t\"./mt\": 82,\n\t\"./mt.js\": 82,\n\t\"./my\": 83,\n\t\"./my.js\": 83,\n\t\"./nb\": 84,\n\t\"./nb.js\": 84,\n\t\"./ne\": 85,\n\t\"./ne.js\": 85,\n\t\"./nl\": 86,\n\t\"./nl-be\": 87,\n\t\"./nl-be.js\": 87,\n\t\"./nl.js\": 86,\n\t\"./nn\": 88,\n\t\"./nn.js\": 88,\n\t\"./pa-in\": 89,\n\t\"./pa-in.js\": 89,\n\t\"./pl\": 90,\n\t\"./pl.js\": 90,\n\t\"./pt\": 91,\n\t\"./pt-br\": 92,\n\t\"./pt-br.js\": 92,\n\t\"./pt.js\": 91,\n\t\"./ro\": 93,\n\t\"./ro.js\": 93,\n\t\"./ru\": 94,\n\t\"./ru.js\": 94,\n\t\"./sd\": 95,\n\t\"./sd.js\": 95,\n\t\"./se\": 96,\n\t\"./se.js\": 96,\n\t\"./si\": 97,\n\t\"./si.js\": 97,\n\t\"./sk\": 98,\n\t\"./sk.js\": 98,\n\t\"./sl\": 99,\n\t\"./sl.js\": 99,\n\t\"./sq\": 100,\n\t\"./sq.js\": 100,\n\t\"./sr\": 101,\n\t\"./sr-cyrl\": 102,\n\t\"./sr-cyrl.js\": 102,\n\t\"./sr.js\": 101,\n\t\"./ss\": 103,\n\t\"./ss.js\": 103,\n\t\"./sv\": 104,\n\t\"./sv.js\": 104,\n\t\"./sw\": 105,\n\t\"./sw.js\": 105,\n\t\"./ta\": 106,\n\t\"./ta.js\": 106,\n\t\"./te\": 107,\n\t\"./te.js\": 107,\n\t\"./tet\": 108,\n\t\"./tet.js\": 108,\n\t\"./tg\": 109,\n\t\"./tg.js\": 109,\n\t\"./th\": 110,\n\t\"./th.js\": 110,\n\t\"./tl-ph\": 111,\n\t\"./tl-ph.js\": 111,\n\t\"./tlh\": 112,\n\t\"./tlh.js\": 112,\n\t\"./tr\": 113,\n\t\"./tr.js\": 113,\n\t\"./tzl\": 114,\n\t\"./tzl.js\": 114,\n\t\"./tzm\": 115,\n\t\"./tzm-latn\": 116,\n\t\"./tzm-latn.js\": 116,\n\t\"./tzm.js\": 115,\n\t\"./ug-cn\": 117,\n\t\"./ug-cn.js\": 117,\n\t\"./uk\": 118,\n\t\"./uk.js\": 118,\n\t\"./ur\": 119,\n\t\"./ur.js\": 119,\n\t\"./uz\": 120,\n\t\"./uz-latn\": 121,\n\t\"./uz-latn.js\": 121,\n\t\"./uz.js\": 120,\n\t\"./vi\": 122,\n\t\"./vi.js\": 122,\n\t\"./x-pseudo\": 123,\n\t\"./x-pseudo.js\": 123,\n\t\"./yo\": 124,\n\t\"./yo.js\": 124,\n\t\"./zh-cn\": 125,\n\t\"./zh-cn.js\": 125,\n\t\"./zh-hk\": 126,\n\t\"./zh-hk.js\": 126,\n\t\"./zh-tw\": 127,\n\t\"./zh-tw.js\": 127\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 133;","module.exports = {\r\n\tsystemMap: systemMap,\r\n\tconnectionMap: connectionMap,\r\n\tdrawInstructions: drawInstructions\r\n};\r\n\r\nfunction systemMap(json){\r\n\tlet systems = {};\r\n\tlet max = 1;\r\n\tfor(let index = 0;index < json.length;index++){\r\n\t\tlet element = json[index];\r\n\t\tlet system = systems[json[index].name];\r\n\t\tif(typeof system !== \"undefined\"){\r\n\t\t\t//Element exists\r\n\t\t\tsystem.count++;\r\n\t\t\tmax = overrideIfGreater(system.count,max);\r\n\t\t}else{\r\n\t\t\t//Create new element\r\n\t\t\tsystem = createNewSystem(element);\r\n\t\t}\r\n\t\tsystems[system.name] = system;\r\n\r\n\t}\r\n\treturn {map: systems,max: max};\r\n\t\r\n}\r\n\r\nfunction createNewSystem(el){\r\n\treturn {\r\n\t\tname: el.name,\r\n\t\tcount : 1,\r\n\t\t//divide all values by 32 because EDSM stores them as Integers. We need floating point numbers though.\r\n\t\tcoords: {\r\n\t\t\tx: el.x / 32,\r\n\t\t\ty: el.y / 32,\r\n\t\t\tz: el.z / 32\r\n\t\t}\r\n\t};\r\n}\r\n\r\n\r\n\r\n\r\nfunction connectionMap(json){\r\n\tlet connectionMap = {};\r\n\tlet maxVisits = 1;\r\n\tfor(let iterator = 0;iterator < json.length-2;iterator++){\r\n\t\t\r\n\t\tlet sys = [json[iterator], json[iterator + 1]];\r\n\t\tlet name = getConnectionName(sys[0].name,sys[1].name);\r\n\t\tlet connection = connectionMap[name];\r\n\t\t//System not in list yet.\r\n\t\tif(typeof connection === \"undefined\"){\r\n\t\t\tcreateNewConnection(sys[0],sys[1],connectionMap);\r\n\t\t}else{\r\n\t\t//System in list already.\r\n\t\t\tconnection.count++;\r\n\t\t\tmaxVisits = overrideIfGreater(connection.count,maxVisits);\r\n\t\t}\r\n\t}\r\n\treturn {map: connectionMap,max: maxVisits};\r\n}\r\nfunction createNewConnection(sys1,sys2,connectionMap){\r\n\tlet name = getConnectionName(sys1.name, sys2.name);\r\n\r\n\tconnectionMap[name] = {\r\n\t\tname: name,\r\n\t\tcount: 1\r\n\t};\r\n\r\n}\r\n\r\nfunction overrideIfGreater(value,greaterThanThis){\r\n\treturn (value > greaterThanThis) ? value : greaterThanThis;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n *\r\n *\r\n * @param {string} name1\r\n * @param {string} name2\r\n * @returns {string} The name that describes the connection between the two given systems.\r\n */\r\nfunction getConnectionName(name1,name2){\r\n\tlet comparision = name1.toUpperCase().localeCompare(name2.toUpperCase());\r\n\tif(comparision === 1){\r\n\t\treturn name1+\":\"+name2;\r\n\t}else{\r\n\t\treturn name2+\":\"+name1;\r\n\t}\r\n\r\n}\r\n\r\nlet generateColorsAndSizes = require(\"./generateColorsAnSizes\");\r\n\r\nfunction drawInstructions(json,points,lines,maxVisits){\r\n\t//An Object w/ 2 Arrays. One for systems, and one for Connections\r\n\r\n\tlet instructions = {};\r\n\tinstructions.points = generatePointInstructions(points,maxVisits.systems);\r\n\tinstructions.lines = generateLineInstructions(json,lines,points,maxVisits.connections);\r\n\treturn instructions;\r\n}\r\n\r\n\r\nfunction generatePointInstructions(obj,maxValues){\r\n\tlet retArr = [];\r\n\tfor(let key in obj){\r\n\t\tif(!obj.hasOwnProperty(key)){continue;}\r\n\t\tlet element = obj[key];\r\n\t\tlet coords = element.coords;\r\n\t\tlet count = element.count;\r\n\r\n\t\tretArr.push({\r\n\t\t\tcolor: generateColorsAndSizes.generateColor(count,true,maxValues),\r\n\t\t\tsize: generateColorsAndSizes.generatePointSize(count,maxValues),\r\n\t\t\tposition: coords\r\n\t\t});\r\n\r\n\t}\r\n\treturn retArr;\r\n}\r\n/**\r\n *\r\n *\r\n * @param {[]} json\r\n * @param {object} obj\r\n * @param {number} maxValues\r\n */\r\nfunction generateLineInstructions(json,lines,points,maxValues){\r\n\tlet retArr = [];\r\n\tfor(let iterator = 0;iterator<json.length-2; iterator++){\r\n\t\t/*\r\n\t\t*\tFor Each Connection, check if next connection has the same visitCount.\r\n\t\t*\tIf not, create a new point first with the next connections color. This is to ensure that there is no color change inside a connection\r\n\t\t*/\r\n\t\tlet thisObject = json[iterator],nextObject = json[iterator+1],nextnextObject = json[iterator+2];\r\n\t\t//Check if this connection and the next connection have the same count of travels. If yes, there is no need to add another vertex inbetween.\r\n\t\tlet thisConnection = lines[getConnectionName(thisObject.name,nextObject.name)];\r\n\t\tlet nextConnection = lines[getConnectionName(nextObject.name,nextnextObject.name)];\r\n\t\t//The next connection will have the same color → No need to add a vertex inbetween. Only add the first Point of the connection\r\n\t\tif(isUndef(thisConnection) || isUndef(nextConnection)){\r\n\t\t\t//Connection does not exist. Skip\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tlet color = generateColorsAndSizes.generateColor(thisConnection.count,false,maxValues);\r\n\t\tlet position = points[thisObject.name].coords;\r\n\t\tretArr.push({color:color,coords:position});\r\n\t\tif (thisConnection.count !== nextConnection.count){\r\n\t\t\tlet color = generateColorsAndSizes.generateColor(nextConnection.count,false,maxValues);\r\n\t\t\tretArr.push({color:color,coords:points[nextObject.name].coords});\r\n\t\t}\r\n\t\tif(iterator === json.length-2){\r\n\t\t\t//Last loop.\r\n\t\t\t//Add the last connection\r\n\t\t\tlet color = generateColorsAndSizes.generateColor(nextConnection);\r\n\t\t\tretArr.push(\r\n\t\t\t\t{color:color,coords:points[nextObject.name].coords},\r\n\t\t\t\t{color:color,coords:points[nextnextObject.name].coords}\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\treturn retArr;\r\n}\r\n\r\nfunction isUndef(el){\r\n\treturn typeof el === \"undefined\";\r\n}","let definitions = require(\"../../configuration/drawParameters\");\r\nlet chroma = require(\"chroma-js\");\r\nmodule.exports = {generateColor:generateColor,generatePointSize:generatePointSize};\r\n\r\n\r\nfunction generateColor(value,isPoint,maxVisits){\r\n\tlet minmax = [];\r\n\tlet def = (isPoint) ? definitions.systems.color : definitions.connections.color;\r\n\tminmax[1] = (def.useMaxValueFromLogsInstead) ? maxVisits : def.maxVal;\r\n\tminmax[0] = def.minVal;\r\n\tlet color = chroma.scale(def.colorGradient).mode(\"lab\").domain(minmax[0],minmax[1]);\r\n\treturn color(value).num();\r\n}\r\n\r\nfunction generatePointSize(value,maxVisits){\r\n\tlet def = definitions.systems.size;\r\n\t\r\n\tif(def.useSizeMapperInstead){\r\n\t\treturn getSizeMapperSize((def.sizeMapper.useAbsoluteValues)?value:value/maxVisits);\r\n\t}else{\r\n\t\tlet min = def.minSize,max = def.maxSize;\r\n\t\treturn Interpolate(value,[0,maxVisits],[min,max]);\r\n\t\t\r\n\t}\r\n}\r\n\r\n/**\r\n *\r\n *\r\n * @param {number} expects a number between 0 and 1 if useAbsoluteValues is off and a value > 0 if it is on.\r\n */\r\nfunction getSizeMapperSize(value){\r\n\tlet sizeDef = definitions.systems.size.sizeMapper.sizeValues;\r\n\tlet index = 0;\r\n\tlet brokeOut = false;\r\n\tfor(index;index < sizeDef.length;index++){\r\n\t\tif(sizeDef[index][0] >= value){\r\n\t\t\tbrokeOut = true;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\t//Extremas\r\n\tif(!brokeOut){\r\n\t\treturn sizeDef[sizeDef.length-1][1];\r\n\t}\r\n\tif(index === 0){\r\n\t\treturn sizeDef[0][1];\r\n\t}\r\n\t//Interpolate \r\n\treturn Interpolate(value, [sizeDef[index - 1][0], sizeDef[index][0]], [sizeDef[index - 1][1], sizeDef[index][1]]);\r\n}\r\n\r\n/**\r\n *Interpolate value between set1 and apply the value onto set2.\r\n * @param {number} value\r\n * @param {number[]} set1 -> consists of 2 numbers\r\n * @param {number[]} set2 -> consists of 2 numbers\r\n */\r\nfunction Interpolate(value,set1,set2){\r\n\tif(value <= set1[0]){return set2[0];}\r\n\tif(value >= set1[1]){return set2[1];}\r\n\t//Values position between the two values in set1 (0 -> at index 0 || 1 -> at index 1)\r\n\tlet valpos = (value-set1[0])/(set1[1]-set1[0]);\r\n\treturn set2[0]+(set2[1]-set2[0])*valpos;\r\n}","//This is the configuration which determines how systems and connections are drawn on the map.\r\n\r\nmodule.exports = {\r\n\tsystems:{\r\n\t\tcolor:{\r\n\t\t\tcolorGradient: [0x66000E,0x07DB00], \r\n\t\t\tminVal: 0,\r\n\t\t\tmaxVal: 100,\r\n\t\t\t//If this is set, maxVal will be overwritten with whatever is the maximum from the logs.\r\n\t\t\tuseMaxValueFromLogsInstead: true\r\n\t\t},\r\n\t\tsize:{\r\n\t\t\tminSize: 1,\r\n\t\t\tmaxSize: 10,\r\n\t\t\t//If this is true, the more complex SizeMapper will be used instead\r\n\t\t\tuseSizeMapperInstead: true,\r\n\t\t\tsizeMapper: {\r\n\t\t\t\t//This will expect the actual visits (for example 92) rather than a value between 0 and 1\r\n\t\t\t\tuseAbsoluteValues: true,\r\n\t\t\t\t//Here you enter the quantity of visits (use absolute values like 5 or 20 if \"useAbsoluteValues\" \r\n\t\t\t\t//is set, else use a value between 0 and 1). [Quantity of Visits , Size to return]. Linear Interpolation will occur between systems\r\n\t\t\t\tsizeValues: [\r\n\t\t\t\t\t[0,1],[10,10],[20,15],[30,20],[50,25],[100,30],[200,35]\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tconnections:{\r\n\t\tcolor:{\r\n\t\t\tcolorGradient: [0x66000E, 0x07DB00],\r\n\t\t\tminVal: 0,\r\n\t\t\tmaxVal: 100,\r\n\t\t\t//If this is set, maxVal will be overwritten with whatever is the maximum from the logs.\r\n\t\t\tuseMaxValueFromLogsInstead: true\r\n\t\t}\r\n\t}\r\n\r\n};"],"sourceRoot":""}